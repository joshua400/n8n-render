"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.UpdateChatSettingsRequest = exports.ChatHubUpdateAgentRequest = exports.ChatHubCreateAgentRequest = exports.ChatHubConversationsRequest = exports.ChatHubUpdateConversationRequest = exports.ChatHubEditMessageRequest = exports.ChatHubRegenerateMessageRequest = exports.ChatHubSendMessageRequest = exports.chatAttachmentSchema = exports.emptyChatModelsResponse = exports.chatModelsRequestSchema = exports.chatHubConversationModelSchema = exports.PROVIDER_CREDENTIAL_TYPE_MAP = exports.chatHubProviderSchema = exports.chatHubLLMProviderSchema = void 0;
const n8n_workflow_1 = require("n8n-workflow");
const zod_1 = require("zod");
const zod_class_1 = require("zod-class");
exports.chatHubLLMProviderSchema = zod_1.z.enum([
    'openai',
    'anthropic',
    'google',
    'azureOpenAi',
    'azureEntraId',
    'ollama',
    'awsBedrock',
    'vercelAiGateway',
    'xAiGrok',
    'groq',
    'openRouter',
    'deepSeek',
    'cohere',
    'mistralCloud',
]);
exports.chatHubProviderSchema = zod_1.z.enum([
    ...exports.chatHubLLMProviderSchema.options,
    'n8n',
    'custom-agent',
]);
exports.PROVIDER_CREDENTIAL_TYPE_MAP = {
    openai: 'openAiApi',
    anthropic: 'anthropicApi',
    google: 'googlePalmApi',
    ollama: 'ollamaApi',
    azureOpenAi: 'azureOpenAiApi',
    azureEntraId: 'azureEntraCognitiveServicesOAuth2Api',
    awsBedrock: 'aws',
    vercelAiGateway: 'vercelAiGatewayApi',
    xAiGrok: 'xAiApi',
    groq: 'groqApi',
    openRouter: 'openRouterApi',
    deepSeek: 'deepSeekApi',
    cohere: 'cohereApi',
    mistralCloud: 'mistralCloudApi',
};
const openAIModelSchema = zod_1.z.object({
    provider: zod_1.z.literal('openai'),
    model: zod_1.z.string(),
});
const anthropicModelSchema = zod_1.z.object({
    provider: zod_1.z.literal('anthropic'),
    model: zod_1.z.string(),
});
const googleModelSchema = zod_1.z.object({
    provider: zod_1.z.literal('google'),
    model: zod_1.z.string(),
});
const azureOpenAIModelSchema = zod_1.z.object({
    provider: zod_1.z.literal('azureOpenAi'),
    model: zod_1.z.string(),
});
const azureEntraIdModelSchema = zod_1.z.object({
    provider: zod_1.z.literal('azureEntraId'),
    model: zod_1.z.string(),
});
const ollamaModelSchema = zod_1.z.object({
    provider: zod_1.z.literal('ollama'),
    model: zod_1.z.string(),
});
const awsBedrockModelSchema = zod_1.z.object({
    provider: zod_1.z.literal('awsBedrock'),
    model: zod_1.z.string(),
});
const vercelAiGatewaySchema = zod_1.z.object({
    provider: zod_1.z.literal('vercelAiGateway'),
    model: zod_1.z.string(),
});
const xAiGrokModelSchema = zod_1.z.object({
    provider: zod_1.z.literal('xAiGrok'),
    model: zod_1.z.string(),
});
const groqModelSchema = zod_1.z.object({
    provider: zod_1.z.literal('groq'),
    model: zod_1.z.string(),
});
const openRouterModelSchema = zod_1.z.object({
    provider: zod_1.z.literal('openRouter'),
    model: zod_1.z.string(),
});
const deepSeekModelSchema = zod_1.z.object({
    provider: zod_1.z.literal('deepSeek'),
    model: zod_1.z.string(),
});
const cohereModelSchema = zod_1.z.object({
    provider: zod_1.z.literal('cohere'),
    model: zod_1.z.string(),
});
const mistralCloudModelSchema = zod_1.z.object({
    provider: zod_1.z.literal('mistralCloud'),
    model: zod_1.z.string(),
});
const n8nModelSchema = zod_1.z.object({
    provider: zod_1.z.literal('n8n'),
    workflowId: zod_1.z.string(),
});
const chatAgentSchema = zod_1.z.object({
    provider: zod_1.z.literal('custom-agent'),
    agentId: zod_1.z.string(),
});
exports.chatHubConversationModelSchema = zod_1.z.discriminatedUnion('provider', [
    openAIModelSchema,
    anthropicModelSchema,
    googleModelSchema,
    azureOpenAIModelSchema,
    azureEntraIdModelSchema,
    ollamaModelSchema,
    awsBedrockModelSchema,
    vercelAiGatewaySchema,
    xAiGrokModelSchema,
    groqModelSchema,
    openRouterModelSchema,
    deepSeekModelSchema,
    cohereModelSchema,
    mistralCloudModelSchema,
    n8nModelSchema,
    chatAgentSchema,
]);
exports.chatModelsRequestSchema = zod_1.z.object({
    credentials: zod_1.z.record(exports.chatHubProviderSchema, zod_1.z.string().nullable()),
});
exports.emptyChatModelsResponse = {
    openai: { models: [] },
    anthropic: { models: [] },
    google: { models: [] },
    azureOpenAi: { models: [] },
    azureEntraId: { models: [] },
    ollama: { models: [] },
    awsBedrock: { models: [] },
    vercelAiGateway: { models: [] },
    xAiGrok: { models: [] },
    groq: { models: [] },
    openRouter: { models: [] },
    deepSeek: { models: [] },
    cohere: { models: [] },
    mistralCloud: { models: [] },
    n8n: { models: [] },
    'custom-agent': { models: [] },
};
exports.chatAttachmentSchema = zod_1.z.object({
    data: zod_1.z.string(),
    mimeType: zod_1.z.string(),
    fileName: zod_1.z.string(),
});
class ChatHubSendMessageRequest extends zod_class_1.Z.class({
    messageId: zod_1.z.string().uuid(),
    sessionId: zod_1.z.string().uuid(),
    message: zod_1.z.string(),
    model: exports.chatHubConversationModelSchema,
    previousMessageId: zod_1.z.string().uuid().nullable(),
    credentials: zod_1.z.record(zod_1.z.object({
        id: zod_1.z.string(),
        name: zod_1.z.string(),
    })),
    tools: zod_1.z.array(n8n_workflow_1.INodeSchema),
    attachments: zod_1.z.array(exports.chatAttachmentSchema),
    agentName: zod_1.z.string(),
}) {
}
exports.ChatHubSendMessageRequest = ChatHubSendMessageRequest;
class ChatHubRegenerateMessageRequest extends zod_class_1.Z.class({
    model: exports.chatHubConversationModelSchema,
    credentials: zod_1.z.record(zod_1.z.object({
        id: zod_1.z.string(),
        name: zod_1.z.string(),
    })),
}) {
}
exports.ChatHubRegenerateMessageRequest = ChatHubRegenerateMessageRequest;
class ChatHubEditMessageRequest extends zod_class_1.Z.class({
    message: zod_1.z.string(),
    messageId: zod_1.z.string().uuid(),
    model: exports.chatHubConversationModelSchema,
    credentials: zod_1.z.record(zod_1.z.object({
        id: zod_1.z.string(),
        name: zod_1.z.string(),
    })),
}) {
}
exports.ChatHubEditMessageRequest = ChatHubEditMessageRequest;
class ChatHubUpdateConversationRequest extends zod_class_1.Z.class({
    title: zod_1.z.string().optional(),
    credentialId: zod_1.z.string().max(36).optional(),
    agent: zod_1.z
        .object({
        model: exports.chatHubConversationModelSchema,
        name: zod_1.z.string(),
    })
        .optional(),
    tools: zod_1.z.array(n8n_workflow_1.INodeSchema).optional(),
}) {
}
exports.ChatHubUpdateConversationRequest = ChatHubUpdateConversationRequest;
class ChatHubConversationsRequest extends zod_class_1.Z.class({
    limit: zod_1.z.coerce.number().int().min(1).max(100),
    cursor: zod_1.z.string().uuid().optional(),
}) {
}
exports.ChatHubConversationsRequest = ChatHubConversationsRequest;
class ChatHubCreateAgentRequest extends zod_class_1.Z.class({
    name: zod_1.z.string().min(1).max(128),
    description: zod_1.z.string().max(512).optional(),
    systemPrompt: zod_1.z.string().min(1),
    credentialId: zod_1.z.string(),
    provider: exports.chatHubLLMProviderSchema,
    model: zod_1.z.string().max(64),
    tools: zod_1.z.array(n8n_workflow_1.INodeSchema),
}) {
}
exports.ChatHubCreateAgentRequest = ChatHubCreateAgentRequest;
class ChatHubUpdateAgentRequest extends zod_class_1.Z.class({
    name: zod_1.z.string().min(1).max(128).optional(),
    description: zod_1.z.string().max(512).optional(),
    systemPrompt: zod_1.z.string().min(1).optional(),
    credentialId: zod_1.z.string().optional(),
    provider: exports.chatHubProviderSchema.optional(),
    model: zod_1.z.string().max(64).optional(),
    tools: zod_1.z.array(n8n_workflow_1.INodeSchema).optional(),
}) {
}
exports.ChatHubUpdateAgentRequest = ChatHubUpdateAgentRequest;
const chatProviderSettingsSchema = zod_1.z.object({
    provider: exports.chatHubLLMProviderSchema,
    enabled: zod_1.z.boolean().optional(),
    credentialId: zod_1.z.string().nullable(),
    allowedModels: zod_1.z.array(zod_1.z.object({
        displayName: zod_1.z.string(),
        model: zod_1.z.string(),
        isManual: zod_1.z.boolean().optional(),
    })),
    createdAt: zod_1.z.string(),
    updatedAt: zod_1.z.string().nullable(),
});
class UpdateChatSettingsRequest extends zod_class_1.Z.class({
    payload: chatProviderSettingsSchema,
}) {
}
exports.UpdateChatSettingsRequest = UpdateChatSettingsRequest;
//# sourceMappingURL=chat-hub.js.map