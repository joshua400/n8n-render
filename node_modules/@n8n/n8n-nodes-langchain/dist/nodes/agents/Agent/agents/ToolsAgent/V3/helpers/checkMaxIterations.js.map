{"version":3,"sources":["../../../../../../../../nodes/agents/Agent/agents/ToolsAgent/V3/helpers/checkMaxIterations.ts"],"sourcesContent":["import { NodeOperationError } from 'n8n-workflow';\nimport type { INode, EngineResponse } from 'n8n-workflow';\n\nimport type { RequestResponseMetadata } from '../types';\n\n/**\n * Checks if the maximum iteration limit has been reached and throws an error if so.\n *\n * This function is called at the start of each agent execution to enforce\n * the maximum number of tool call iterations allowed.\n *\n * @param response - The engine response containing iteration metadata (if this is a continuation)\n * @param maxIterations - The maximum number of iterations allowed\n * @param node - The current node (for error context)\n * @throws {NodeOperationError} When the iteration count reaches or exceeds maxIterations\n *\n * @example\n * ```typescript\n * const response: EngineResponse<RequestResponseMetadata> = {\n *   // ... response data\n *   metadata: { iterationCount: 3 }\n * };\n *\n * // This will throw if iterationCount >= maxIterations\n * checkMaxIterations(response, 2, node);\n * ```\n */\nexport function checkMaxIterations(\n\tresponse: EngineResponse<RequestResponseMetadata> | undefined,\n\tmaxIterations: number,\n\tnode: INode,\n): void {\n\t// Only check if this is a continuation (response has iteration count)\n\tif (response?.metadata?.iterationCount === undefined) {\n\t\treturn;\n\t}\n\n\tif (response.metadata.iterationCount >= maxIterations) {\n\t\tthrow new NodeOperationError(\n\t\t\tnode,\n\t\t\t`Max iterations (${maxIterations}) reached. The agent could not complete the task within the allowed number of iterations.`,\n\t\t);\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAmC;AA2B5B,SAAS,mBACf,UACA,eACA,MACO;AAEP,MAAI,UAAU,UAAU,mBAAmB,QAAW;AACrD;AAAA,EACD;AAEA,MAAI,SAAS,SAAS,kBAAkB,eAAe;AACtD,UAAM,IAAI;AAAA,MACT;AAAA,MACA,mBAAmB,aAAa;AAAA,IACjC;AAAA,EACD;AACD;","names":[]}